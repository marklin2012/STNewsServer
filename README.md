# å¯¼èˆª

- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [ç³»ç»Ÿå¿…è£…ä¾èµ–](#ç³»ç»Ÿå¿…è£…ä¾èµ–)(å®‰è£…å¿…çœ‹ ğŸ‘)
- [å¦‚ä½•å®‰è£…](#å¦‚ä½•å®‰è£…)(å®‰è£…å¿…çœ‹ ğŸ‘)
- [å¼€å‘å¸¸ç”¨å‘½ä»¤](#å¼€å‘å¸¸ç”¨å‘½ä»¤)(ç¼–ç å¿…çœ‹ âŒ¨ï¸)
- [é¡¹ç›®ç›®å½•ç»“æ„](#é¡¹ç›®ç›®å½•ç»“æ„)(ç¼–ç å¿…çœ‹ âŒ¨ï¸)
- [åˆ†æ”¯è§„èŒƒ](#åˆ†æ”¯è§„èŒƒ)(ç¼–ç å¿…çœ‹ âŒ¨ï¸)
- [ä»£ç æäº¤](#ä»£ç æäº¤)(ç¼–ç å¿…çœ‹ âŒ¨ï¸)
- [å¦‚ä½•å¼€å‘æ¥å£](#å¦‚ä½•å¼€å‘æ¥å£)(ç¼–ç å¿…çœ‹ âŒ¨ï¸)(å¾…è¡¥å……)

# æŠ€æœ¯æ ˆ

- Node.js
- MongoDB
- TypeScript
- egg.js
- Koa

# ç³»ç»Ÿå¿…è£…ä¾èµ–

- [Node.js 14+](https://nodejs.org/zh-cn/)
- [nrm](https://github.com/Pana/nrm) (ç®¡ç† node æº)
- [Yarn](https://yarnpkg.com/)
- [MongoDB 5.0](https://docs.mongodb.com/guides/server/install/)

## å®‰è£… MongoDB-5.0 (macOS)
1. éœ€è¦å…ˆå®‰è£… xcode å·¥å…·

```ssh
xcode-select --install
```

2. å®‰è£… mongodb 5.0

```ssh

brew tap mongodb/brew
brew install mongodb-community@5.0

```

3. å¯åŠ¨ mondb æœåŠ¡

```ssh
brew services start mongodb-community@5.0
```

# å¦‚ä½•å®‰è£…

1. å®‰è£…ç³»ç»Ÿä¾èµ–
  è¯·æŒ‰ç…§ä¸Šè¿°çš„æ¸…å•å®‰è£…ï¼Œç‰ˆæœ¬ç¬¦åˆè¦æ±‚å³å¯

2. å®‰è£…å¹¶é…ç½® yarn
  > yarn
  > ä¸è¦ä½¿ç”¨ npm!

```bash
brew install yarn
```

3. nrm ä½¿ç”¨ æ·˜å®æº

```bash
nrm use taobao
```

4. ä¸‹è½½é¡¹ç›®ä»£ç 
  
5. å®‰è£…ä¾èµ–

```bash
yarn
```

6. å¯åŠ¨é¡¹ç›®

```bash
yarn dev
```


# å¼€å‘å¸¸ç”¨å‘½ä»¤


```bash
yarn dev      # å¼€å‘ä»¥å¯åŠ¨é¡¹ç›®
```

# é¡¹ç›®ç›®å½•ç»“æ„


```bash
.
â”œâ”€â”€ package.json
â”œâ”€â”€ app
â”‚   â”œâ”€â”€ router.js               # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ controller
â”‚   |   â””â”€â”€ home.js
â”‚   â””â”€â”€ service (å¯é€‰)
â”‚       â””â”€â”€ user.js
â”œâ”€â”€ config
â”‚   â”œâ”€â”€ plugin.js
â”‚   â”œâ”€â”€ config.default.js
â”‚   â”œâ”€â”€ config.prod.js
â”‚   â””â”€â”€ config.local.js (å¯é€‰)
â””â”€â”€ test
    â”œâ”€â”€ middleware
    |   â””â”€â”€ response_time.test.js
    â””â”€â”€ controller
        â””â”€â”€ home.test.js
```

# åˆ†æ”¯è§„èŒƒ

æäº¤çš„æ ¼å¼ä¸ºï¼š`<type>: <subject>`ï¼Œtypeç”¨äºè¯´æ˜ commit çš„ç±»åˆ«ï¼Œsubjectæ˜¯ commit åŸå› çš„ç®€çŸ­æè¿°ï¼Œtypeå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ç±»åˆ«ï¼š

| commit å‰ç¼€      | è¯´æ˜     |
| ------------- | -------- |
| **init:**     | é¡¹ç›®åˆå§‹åŒ– |
| **feat:**     | å¢åŠ æ–°åŠŸèƒ½ |
| **fix:**      | ä¿®è¡¥bug   |
| **doc:**      | ä¿®æ”¹æ–‡æ¡£   |
| **change:**   | ä¸å½±å“ä»£ç åŠŸèƒ½çš„å˜åŠ¨   |
| **refactor:** | å¯¹æŸä¸ªåŠŸèƒ½è¿›è¡Œäº†é‡æ„   |
| **test:**     | å¢åŠ æµ‹è¯•   |
| **chore:**     | æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨   |

> æ¯”å¦‚æˆ‘åœ¨å·¥ç¨‹é‡Œæ–°å¢äº†ä¸€ä¸ªç»„ä»¶ï¼Œ commit çš„æ ¼å¼å°±æ˜¯ feat:æ–°å¢XXç»„ä»¶

# ä»£ç æäº¤

ï¼ˆå¾…éƒ¨ç½²æäº¤è¯­æ³•æ£€æŸ¥ï¼‰~~ä»£ç æäº¤å‰ä¼š**è‡ªåŠ¨**æ£€æŸ¥ä»£ç è¯­æ³•ï¼Œæ£€æŸ¥ä¸è¿‡å…³ä¼šæäº¤å¤±è´¥ã€‚~~

éœ€è¦æ³¨æ„ï¼š

- æ£€æŸ¥æ¯è¡Œè¢« staged çš„ä»£ç ï¼Œä¸è¦æäº¤æ— å…³é‡è¦çš„ä»£ç ï¼
- ä¸è¦æäº¤æ— æ„ä¹‰çš„ `print()`
- åˆå¹¶ä»£ç æ—¶è®°å¾—é€šè¿‡æ PR çš„æ–¹å¼ï¼Œå¹¶ä¸” assign ç»™ç®¡ç†å‘˜ï¼š


# å¦‚ä½•å¼€å‘æ¥å£

1. åˆ›å»º Modelï¼Œ å®šä¹‰æ•°æ®ç»“æ„
2. åˆ›å»º controller æ–‡ä»¶ï¼Œç¼–å†™ä¸šåŠ¡é€»è¾‘
3. åœ¨ `router.ts` é‡Œç»™ API æ·»åŠ è·¯ç”±

å…·ä½“æ“ä½œå¦‚ä¸‹ï¼ˆä»¥ testUser ä¸ºä¾‹ï¼‰:

## 1. åˆ›å»º Modelï¼Œå®šä¹‰æ•°æ®ç»“æ„

åœ¨ `app/model/` ä¸‹æ–°å»º `user.ts` æ–‡ä»¶

å®šä¹‰ Model æ—¶ï¼Œæ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

1. å¿…å¡«å­—æ®µï¼Œéœ€åŠ ä¸Š `required: true`
2. å¯¹äºéœ€è¦è¢«æ£€ç´¢çš„å­—æ®µï¼Œéœ€åŠ ä¸Šç´¢å¼• `index: true`
3. å¦‚æœè¯¥æ•°æ®å¯ä»¥è¢«åˆ é™¤ï¼Œéœ€åŠ ä¸Š `deleted` å­—æ®µ

## 2. åˆ›å»º controller æ–‡ä»¶ï¼Œç¼–å†™ä¸šåŠ¡é€»è¾‘

åœ¨ `app/controller/` ä¸‹æ–°å»º `user.ts`, å¹¶å®ç°ä¸šåŠ¡é€»è¾‘

## 3. åœ¨ `router.ts` é‡Œç»™ API æ·»åŠ è·¯ç”±

åœ¨ `app/router.ts` æ–‡ä»¶å†…æ·»åŠ æ¥å£è·¯ç”±

ä¾‹å¦‚ï¼š 

```js
router.get('/test/adduser', controller.user.addUserTest)
```



